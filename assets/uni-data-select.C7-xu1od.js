import{M as e,N as t,o as s,c as i,w as l,A as a,a as o,k as r,n,b as c,s as u,t as h,l as d,i as m,g as p,h as f,F as y,O as g,I as b,P as _,Q as S,J as x,j as C,S as v}from"./index-HWal9xG4.js";import{_ as k}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{r as w,a as I,Z as D}from"./uni-easyinput.vue_vue_type_style_index_0_scoped_a969df6c_lang.BDN2OWkL.js";const B=k({name:"uniFormsItem",options:{virtualHost:!0},provide(){return{uniFormItem:this}},inject:{form:{from:"uniForm",default:null}},props:{rules:{type:Array,default:()=>null},name:{type:[String,Array],default:""},required:{type:Boolean,default:!1},label:{type:String,default:""},labelWidth:{type:[String,Number],default:""},labelAlign:{type:String,default:""},errorMessage:{type:[String,Boolean],default:""},leftIcon:String,iconColor:{type:String,default:"#606266"}},data:()=>({errMsg:"",userRules:null,localLabelAlign:"left",localLabelWidth:"70px",localLabelPos:"left",border:!1,isFirstBorder:!1}),computed:{msg(){return this.errorMessage||this.errMsg}},watch:{"form.formRules"(e){this.init()},"form.labelWidth"(e){this.localLabelWidth=this._labelWidthUnit(e)},"form.labelPosition"(e){this.localLabelPos=this._labelPosition()},"form.labelAlign"(e){}},created(){this.init(!0),this.name&&this.form&&this.$watch((()=>this.form._getDataValue(this.name,this.form.localData)),((e,t)=>{if(!this.form._isEqual(e,t)){const t=this.itemSetValue(e);this.onFieldChange(t,!1)}}),{immediate:!1})},unmounted(){this.__isUnmounted=!0,this.unInit()},methods:{setRules(e=null){this.userRules=e,this.init(!1)},setValue(){},async onFieldChange(s,i=!0){const{formData:l,localData:a,errShowType:o,validateCheck:r,validateTrigger:n,_isRequiredField:c,_realName:u}=this.form,h=u(this.name);s||(s=this.form.formData[h]);const d=this.itemRules.rules&&this.itemRules.rules.length;if(!this.validator||!d||0===d)return;const m=c(this.itemRules.rules||[]);let p=null;return"bind"===n||i?(p=await this.validator.validateUpdate({[h]:s},l),m||void 0!==s&&""!==s||(p=null),p&&p.errorMessage?("undertext"===o&&(this.errMsg=p?p.errorMessage:""),"toast"===o&&e({title:p.errorMessage||"校验错误",icon:"none"}),"modal"===o&&t({title:"提示",content:p.errorMessage||"校验错误"})):this.errMsg="",r(p||null)):this.errMsg="",p||null},init(e=!1){const{validator:t,formRules:s,childrens:i,formData:l,localData:a,_realName:o,labelWidth:r,_getDataValue:n,_setDataValue:c}=this.form||{};if(this.localLabelAlign=this._justifyContent(),this.localLabelWidth=this._labelWidthUnit(r),this.localLabelPos=this._labelPosition(),this.form&&e&&i.push(this),!t||!s)return;this.form.isFirstBorder||(this.form.isFirstBorder=!0,this.isFirstBorder=!0),this.group&&(this.group.isFirstBorder||(this.group.isFirstBorder=!0,this.isFirstBorder=!0)),this.border=this.form.border;const u=o(this.name),h=this.userRules||this.rules;"object"==typeof s&&h&&(s[u]={rules:h},t.updateSchema(s));const d=s[u]||{};this.itemRules=d,this.validator=t,this.itemSetValue(n(this.name,a))},unInit(){if(this.form){const{childrens:e,formData:t,_realName:s}=this.form;e.forEach(((e,i)=>{e===this&&(this.form.childrens.splice(i,1),delete t[s(e.name)])}))}},itemSetValue(e){const t=this.form._realName(this.name),s=this.itemRules.rules||[],i=this.form._getValue(t,e,s);return this.form._setDataValue(t,this.form.formData,i),i},clearValidate(){this.errMsg=""},_isRequired(){return this.required},_justifyContent(){if(this.form){const{labelAlign:e}=this.form;let t=this.labelAlign?this.labelAlign:e;if("left"===t)return"flex-start";if("center"===t)return"center";if("right"===t)return"flex-end"}return"flex-start"},_labelWidthUnit(e){return this.num2px(this.labelWidth?this.labelWidth:e||(this.label?70:"auto"))},_labelPosition(){return this.form&&this.form.labelPosition||"left"},isTrigger:(e,t,s)=>"submit"!==e&&e?"bind":void 0===e?"bind"!==t?t?"submit":""===s?"bind":"submit":"bind":"submit",num2px:e=>"number"==typeof e?`${e}px`:e}},[["render",function(e,t,p,f,y,g){const b=d,_=m;return s(),i(_,{class:r(["uni-forms-item",["is-direction-"+y.localLabelPos,y.border?"uni-forms-item--border":"",y.border&&y.isFirstBorder?"is-first-border":""]])},{default:l((()=>[a(e.$slots,"label",{},(()=>[o(_,{class:r(["uni-forms-item__label",{"no-label":!p.label&&!p.required}]),style:n({width:y.localLabelWidth,justifyContent:y.localLabelAlign})},{default:l((()=>[p.required?(s(),i(b,{key:0,class:"is-required"},{default:l((()=>[c("*")])),_:1})):u("",!0),o(b,null,{default:l((()=>[c(h(p.label),1)])),_:1})])),_:1},8,["class","style"])]),!0),o(_,{class:"uni-forms-item__content"},{default:l((()=>[a(e.$slots,"default",{},void 0,!0),o(_,{class:r(["uni-forms-item__error",{"msg--active":g.msg}])},{default:l((()=>[o(b,null,{default:l((()=>[c(h(g.msg),1)])),_:1})])),_:1},8,["class"])])),_:3})])),_:3},8,["class"])}],["__scopeId","data-v-a0d8281b"]]);function $(e){let t="";for(let s in e){t+=`${s}:${e[s]};`}return t}const V=k({name:"uni-easyinput",emits:["click","iconClick","update:modelValue","input","focus","blur","confirm","clear","eyes","change","keyboardheightchange"],model:{prop:"modelValue",event:"update:modelValue"},options:{virtualHost:!0},inject:{form:{from:"uniForm",default:null},formItem:{from:"uniFormItem",default:null}},props:{name:String,value:[Number,String],modelValue:[Number,String],type:{type:String,default:"text"},clearable:{type:Boolean,default:!0},autoHeight:{type:Boolean,default:!1},placeholder:{type:String,default:" "},placeholderStyle:String,focus:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},maxlength:{type:[Number,String],default:140},confirmType:{type:String,default:"done"},clearSize:{type:[Number,String],default:24},inputBorder:{type:Boolean,default:!0},prefixIcon:{type:String,default:""},suffixIcon:{type:String,default:""},trim:{type:[Boolean,String],default:!1},cursorSpacing:{type:Number,default:0},passwordIcon:{type:Boolean,default:!0},adjustPosition:{type:Boolean,default:!0},primaryColor:{type:String,default:"#2979ff"},styles:{type:Object,default:()=>({color:"#333",backgroundColor:"#fff",disableColor:"#F7F6F6",borderColor:"#e5e5e5"})},errorMessage:{type:[String,Boolean],default:""}},data:()=>({focused:!1,val:"",showMsg:"",border:!1,isFirstBorder:!1,showClearIcon:!1,showPassword:!1,focusShow:!1,localMsg:"",isEnter:!1}),computed:{isVal(){const e=this.val;return!(!e&&0!==e)},msg(){return this.localMsg||this.errorMessage},inputMaxlength(){return Number(this.maxlength)},boxStyle(){return`color:${this.inputBorder&&this.msg?"#e43d33":this.styles.color};`},inputContentClass(){return function(e){let t="";for(let s in e)e[s]&&(t+=`${s} `);return t}({"is-input-border":this.inputBorder,"is-input-error-border":this.inputBorder&&this.msg,"is-textarea":"textarea"===this.type,"is-disabled":this.disabled,"is-focused":this.focusShow})},inputContentStyle(){const e=this.focusShow?this.primaryColor:this.styles.borderColor;return $({"border-color":(this.inputBorder&&this.msg?"#dd524d":e)||"#e5e5e5","background-color":this.disabled?this.styles.disableColor:this.styles.backgroundColor})},inputStyle(){return $({"padding-right":"password"===this.type||this.clearable||this.prefixIcon?"":"10px","padding-left":this.prefixIcon?"":"10px"})}},watch:{value(e){this.val=null!==e?e:""},modelValue(e){this.val=null!==e?e:""},focus(e){this.$nextTick((()=>{this.focused=this.focus,this.focusShow=this.focus}))}},created(){this.init(),this.form&&this.formItem&&this.$watch("formItem.errMsg",(e=>{this.localMsg=e}))},mounted(){this.$nextTick((()=>{this.focused=this.focus,this.focusShow=this.focus}))},methods:{init(){this.value||0===this.value?this.val=this.value:this.modelValue||0===this.modelValue||""===this.modelValue?this.val=this.modelValue:this.val=""},onClickIcon(e){this.$emit("iconClick",e)},onEyes(){this.showPassword=!this.showPassword,this.$emit("eyes",this.showPassword)},onInput(e){let t=e.detail.value;this.trim&&("boolean"==typeof this.trim&&this.trim&&(t=this.trimStr(t)),"string"==typeof this.trim&&(t=this.trimStr(t,this.trim))),this.errMsg&&(this.errMsg=""),this.val=t,this.$emit("input",t),this.$emit("update:modelValue",t)},onFocus(){this.$nextTick((()=>{this.focused=!0})),this.$emit("focus",null)},_Focus(e){this.focusShow=!0,this.$emit("focus",e)},onBlur(){this.focused=!1,this.$emit("blur",null)},_Blur(e){if(e.detail.value,this.focusShow=!1,this.$emit("blur",e),!1===this.isEnter&&this.$emit("change",this.val),this.form&&this.formItem){const{validateTrigger:e}=this.form;"blur"===e&&this.formItem.onFieldChange()}},onConfirm(e){this.$emit("confirm",this.val),this.isEnter=!0,this.$emit("change",this.val),this.$nextTick((()=>{this.isEnter=!1}))},onClear(e){this.val="",this.$emit("input",""),this.$emit("update:modelValue",""),this.$emit("clear")},onkeyboardheightchange(e){this.$emit("keyboardheightchange",e)},trimStr:(e,t="both")=>"both"===t?e.trim():"left"===t?e.trimLeft():"right"===t?e.trimRight():"start"===t?e.trimStart():"end"===t?e.trimEnd():"all"===t?e.replace(/\s+/g,""):e}},[["render",function(e,t,c,h,d,_){const S=w(p("uni-icons"),I),x=g,C=b,v=m;return s(),i(v,{class:r(["uni-easyinput",{"uni-easyinput-error":_.msg}]),style:n(_.boxStyle)},{default:l((()=>[o(v,{class:r(["uni-easyinput__content",_.inputContentClass]),style:n(_.inputContentStyle)},{default:l((()=>[c.prefixIcon?(s(),i(S,{key:0,class:"content-clear-icon",type:c.prefixIcon,color:"#c0c4cc",onClick:t[0]||(t[0]=e=>_.onClickIcon("prefix")),size:"22"},null,8,["type"])):u("",!0),a(e.$slots,"left",{},void 0,!0),"textarea"===c.type?(s(),i(x,{key:1,class:r(["uni-easyinput__content-textarea",{"input-padding":c.inputBorder}]),name:c.name,value:d.val,placeholder:c.placeholder,placeholderStyle:c.placeholderStyle,disabled:c.disabled,"placeholder-class":"uni-easyinput__placeholder-class",maxlength:_.inputMaxlength,focus:d.focused,autoHeight:c.autoHeight,"cursor-spacing":c.cursorSpacing,"adjust-position":c.adjustPosition,onInput:_.onInput,onBlur:_._Blur,onFocus:_._Focus,onConfirm:_.onConfirm,onKeyboardheightchange:_.onkeyboardheightchange},null,8,["class","name","value","placeholder","placeholderStyle","disabled","maxlength","focus","autoHeight","cursor-spacing","adjust-position","onInput","onBlur","onFocus","onConfirm","onKeyboardheightchange"])):(s(),i(C,{key:2,type:"password"===c.type?"text":c.type,class:"uni-easyinput__content-input",style:n(_.inputStyle),name:c.name,value:d.val,password:!d.showPassword&&"password"===c.type,placeholder:c.placeholder,placeholderStyle:c.placeholderStyle,"placeholder-class":"uni-easyinput__placeholder-class",disabled:c.disabled,maxlength:_.inputMaxlength,focus:d.focused,confirmType:c.confirmType,"cursor-spacing":c.cursorSpacing,"adjust-position":c.adjustPosition,onFocus:_._Focus,onBlur:_._Blur,onInput:_.onInput,onConfirm:_.onConfirm,onKeyboardheightchange:_.onkeyboardheightchange},null,8,["type","style","name","value","password","placeholder","placeholderStyle","disabled","maxlength","focus","confirmType","cursor-spacing","adjust-position","onFocus","onBlur","onInput","onConfirm","onKeyboardheightchange"])),"password"===c.type&&c.passwordIcon?(s(),f(y,{key:3},[_.isVal?(s(),i(S,{key:0,class:r(["content-clear-icon",{"is-textarea-icon":"textarea"===c.type}]),type:d.showPassword?"eye-slash-filled":"eye-filled",size:22,color:d.focusShow?c.primaryColor:"#c0c4cc",onClick:_.onEyes},null,8,["class","type","color","onClick"])):u("",!0)],64)):u("",!0),c.suffixIcon?(s(),f(y,{key:4},[c.suffixIcon?(s(),i(S,{key:0,class:"content-clear-icon",type:c.suffixIcon,color:"#c0c4cc",onClick:t[1]||(t[1]=e=>_.onClickIcon("suffix")),size:"22"},null,8,["type"])):u("",!0)],64)):(s(),f(y,{key:5},[c.clearable&&_.isVal&&!c.disabled&&"textarea"!==c.type?(s(),i(S,{key:0,class:r(["content-clear-icon",{"is-textarea-icon":"textarea"===c.type}]),type:"clear",size:c.clearSize,color:_.msg?"#dd524d":d.focusShow?c.primaryColor:"#c0c4cc",onClick:_.onClear},null,8,["class","size","color","onClick"])):u("",!0)],64)),a(e.$slots,"right",{},void 0,!0)])),_:3},8,["class","style"])])),_:3},8,["class","style"])}],["__scopeId","data-v-a969df6c"]]);const F=k({name:"uni-data-select",mixins:[D.mixinDatacom||{}],props:{localdata:{type:Array,default:()=>[]},value:{type:[String,Number],default:""},modelValue:{type:[String,Number],default:""},label:{type:String,default:""},placeholder:{type:String,default:"请选择"},emptyTips:{type:String,default:"无选项"},clear:{type:Boolean,default:!0},defItem:{type:Number,default:0},disabled:{type:Boolean,default:!1},format:{type:String,default:""},placement:{type:String,default:"bottom"}},data:()=>({showSelector:!1,current:"",mixinDatacomResData:[],apps:[],channels:[],cacheKey:"uni-data-select-lastSelectedValue"}),created(){this.debounceGet=this.debounce((()=>{this.query()}),300),this.collection&&!this.localdata.length&&this.debounceGet()},computed:{typePlaceholder(){const e=this.placeholder,t={"opendb-stat-app-versions":"版本","opendb-app-channels":"渠道","opendb-app-list":"应用"}[this.collection];return t?e+t:e},valueCom(){return this.modelValue},textShow(){let e=this.current;return e.length>10?e.slice(0,25)+"...":e},getOffsetByPlacement(){switch(this.placement){case"top":return"bottom:calc(100% + 12px);";case"bottom":return"top:calc(100% + 12px);"}}},watch:{localdata:{immediate:!0,handler(e,t){Array.isArray(e)&&t!==e&&(this.mixinDatacomResData=e)}},valueCom(e,t){this.initDefVal()},mixinDatacomResData:{immediate:!0,handler(e){e.length&&this.initDefVal()}}},methods:{debounce(e,t=100){let s=null;return function(...i){s&&clearTimeout(s),s=setTimeout((()=>{e.apply(this,i)}),t)}},query(){this.mixinDatacomEasyGet()},onMixinDatacomPropsChange(){this.collection&&this.debounceGet()},initDefVal(){let e="";if(!this.valueCom&&0!==this.valueCom||this.isDisabled(this.valueCom)){let t;if(this.collection&&(t=this.getCache()),t||0===t)e=t;else{let t="";this.defItem>0&&this.defItem<=this.mixinDatacomResData.length&&(t=this.mixinDatacomResData[this.defItem-1].value),e=t}(e||0===e)&&this.emit(e)}else e=this.valueCom;const t=this.mixinDatacomResData.find((t=>t.value===e));this.current=t?this.formatItemName(t):""},isDisabled(e){let t=!1;return this.mixinDatacomResData.forEach((s=>{s.value===e&&(t=s.disable)})),t},clearVal(){this.emit(""),this.collection&&this.removeCache()},change(e){e.disable||(this.showSelector=!1,this.current=this.formatItemName(e),this.emit(e.value))},emit(e){this.$emit("input",e),this.$emit("update:modelValue",e),this.$emit("change",e),this.collection&&this.setCache(e)},toggleSelector(){this.disabled||(this.showSelector=!this.showSelector)},formatItemName(e){let{text:t,value:s,channel_code:i}=e;if(i=i?`(${i})`:"",this.format){let t="";t=this.format;for(let s in e)t=t.replace(new RegExp(`{${s}}`,"g"),e[s]);return t}return this.collection.indexOf("app-list")>0?`${t}(${s})`:t||`未命名${i}`},getLoadData(){return this.mixinDatacomResData},getCurrentCacheKey(){return this.collection},getCache(e=this.getCurrentCacheKey()){return(_(this.cacheKey)||{})[e]},setCache(e,t=this.getCurrentCacheKey()){let s=_(this.cacheKey)||{};s[t]=e,S(this.cacheKey,s)},removeCache(e=this.getCurrentCacheKey()){let t=_(this.cacheKey)||{};delete t[e],S(this.cacheKey,t)}}},[["render",function(e,t,a,g,b,_){const S=m,k=w(p("uni-icons"),I),D=d,B=v;return s(),i(S,{class:"uni-stat__select"},{default:l((()=>[a.label?(s(),f("span",{key:0,class:"uni-label-text hide-on-phone"},h(a.label+"："),1)):u("",!0),o(S,{class:r(["uni-stat-box",{"uni-stat__actived":b.current}])},{default:l((()=>[o(S,{class:r(["uni-select",{"uni-select--disabled":a.disabled}])},{default:l((()=>[o(S,{class:"uni-select__input-box",onClick:_.toggleSelector},{default:l((()=>[b.current?(s(),i(S,{key:0,class:"uni-select__input-text"},{default:l((()=>[c(h(_.textShow),1)])),_:1})):(s(),i(S,{key:1,class:"uni-select__input-text uni-select__input-placeholder"},{default:l((()=>[c(h(_.typePlaceholder),1)])),_:1})),b.current&&a.clear&&!a.disabled?(s(),i(S,{key:2,onClick:x(_.clearVal,["stop"])},{default:l((()=>[o(k,{type:"clear",color:"#c0c4cc",size:"24"})])),_:1},8,["onClick"])):(s(),i(S,{key:3},{default:l((()=>[o(k,{type:b.showSelector?"top":"bottom",size:"14",color:"#999"},null,8,["type"])])),_:1}))])),_:1},8,["onClick"]),b.showSelector?(s(),i(S,{key:0,class:"uni-select--mask",onClick:_.toggleSelector},null,8,["onClick"])):u("",!0),b.showSelector?(s(),i(S,{key:1,class:"uni-select__selector",style:n(_.getOffsetByPlacement)},{default:l((()=>[o(S,{class:r("bottom"==a.placement?"uni-popper__arrow_bottom":"uni-popper__arrow_top")},null,8,["class"]),o(B,{"scroll-y":"true",class:"uni-select__selector-scroll"},{default:l((()=>[0===b.mixinDatacomResData.length?(s(),i(S,{key:0,class:"uni-select__selector-empty"},{default:l((()=>[o(D,null,{default:l((()=>[c(h(a.emptyTips),1)])),_:1})])),_:1})):(s(!0),f(y,{key:1},C(b.mixinDatacomResData,((e,t)=>(s(),i(S,{class:"uni-select__selector-item",key:t,onClick:t=>_.change(e)},{default:l((()=>[o(D,{class:r({"uni-select__selector__disabled":e.disable})},{default:l((()=>[c(h(_.formatItemName(e)),1)])),_:2},1032,["class"])])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1},8,["style"])):u("",!0)])),_:1},8,["class"])])),_:1},8,["class"])])),_:1})}],["__scopeId","data-v-332e6fea"]]);export{B as _,V as a,F as b};
